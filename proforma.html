<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proforma Invoice - GlassERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --light: #f8f9fa;
            --dark: #2c3e50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .invoice-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        /* Header */
        .header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--secondary);
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header h2 {
            color: var(--secondary);
            font-size: 1.8rem;
        }
        
        /* Unit Toggle */
        .unit-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--light);
            padding: 15px;
            border-radius: 10px;
            justify-content: center;
        }
        
        .unit-btn {
            padding: 10px 25px;
            border: 2px solid var(--secondary);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .unit-btn.active {
            background: var(--secondary);
            color: white;
        }
        
        /* Dimension Input Section */
        .dimension-section {
            margin-bottom: 30px;
        }
        
        .dimension-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .dimension-group {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
        }
        
        .dimension-group h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Inches Input Style */
        .inches-input {
            display: grid;
            grid-template-columns: 1fr 30px 1fr 30px 1fr;
            gap: 10px;
            align-items: center;
        }
        
        .inches-input input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            text-align: center;
            font-weight: 600;
        }
        
        .inches-input span {
            text-align: center;
            font-weight: bold;
            color: var(--primary);
        }
        
        /* MM Input Style */
        .mm-input {
            display: flex;
            gap: 10px;
        }
        
        .mm-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
        }
        
        /* Conversion Display */
        .conversion-display {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }
        
        /* Items Table */
        .items-table-container {
            overflow-x: auto;
            margin: 30px 0;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .items-table th {
            background: linear-gradient(135deg, var(--primary) 0%, #34495e 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .items-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }
        
        .items-table tr:hover {
            background: #f5f5f5;
        }
        
        .size-display {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: var(--primary);
        }
        
        .action-btns {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .icon-btn {
            padding: 8px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .btn-view {
            background: var(--secondary);
            color: white;
        }
        
        .btn-edit {
            background: var(--warning);
            color: white;
        }
        
        .btn-delete {
            background: var(--accent);
            color: white;
        }
        
        /* Add Item Form */
        .add-item-form {
            background: var(--light);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        /* Totals Section */
        .totals-section {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .totals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .total-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed #ddd;
        }
        
        .grand-total {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--success);
            margin-top: 15px;
            padding-top: 15px;
            border-top: 3px solid var(--success);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .main-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .btn-save {
            background: linear-gradient(135deg, var(--success) 0%, #2ecc71 100%);
            color: white;
        }
        
        .btn-print {
            background: linear-gradient(135deg, var(--secondary) 0%, #2980b9 100%);
            color: white;
        }
        
        .btn-calculate {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }
        
        .main-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        /* Footer */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #7f8c8d;
        }
        
        .footer strong {
            color: var(--secondary);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .inches-input {
                grid-template-columns: 1fr 25px 1fr 25px 1fr;
            }
            
            .main-btn {
                padding: 12px 25px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="invoice-card">
            <!-- Header -->
            <div class="header">
                <h1><i class="fas fa-file-invoice-dollar"></i> PROFORMA INVOICE</h1>
                <h2>Glass Manufacturing Company</h2>
            </div>
            
            <!-- Unit Selection -->
            <div class="unit-toggle">
                <button class="unit-btn active" onclick="setActiveUnit('inches')">
                    <i class="fas fa-ruler-vertical"></i> Enter in Inches
                </button>
                <button class="unit-btn" onclick="setActiveUnit('mm')">
                    <i class="fas fa-ruler"></i> Enter in Millimeters
                </button>
            </div>
            
            <!-- Add New Item Form -->
            <div class="add-item-form">
                <h3 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-plus-circle"></i> Add New Glass Item
                </h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Item Description</label>
                        <input type="text" id="itemDesc" placeholder="e.g., Clear Glass 6mm">
                    </div>
                    
                    <div class="form-group">
                        <label>Quantity</label>
                        <input type="number" id="itemQty" value="1" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label>Rate (₹ per sq.ft)</label>
                        <input type="number" id="itemRate" value="450" step="0.01">
                    </div>
                </div>
                
                <!-- Dimensions Input -->
                <div class="dimension-row">
                    <!-- Actual Size -->
                    <div class="dimension-group">
                        <h3><i class="fas fa-expand-arrows-alt"></i> Actual Size</h3>
                        
                        <!-- Inches Input (Default) -->
                        <div id="inchesInput" class="inches-input">
                            <!-- Width -->
                            <input type="number" id="actualWidthFeet" placeholder="Feet" value="4">
                            <span>ft</span>
                            <input type="number" id="actualWidthInches" placeholder="Inches" value="0" min="0" max="11">
                            <span>in</span>
                            <input type="number" id="actualWidthFraction" placeholder="Fraction" value="0" min="0" max="15" step="1">
                            <select id="actualWidthFractionType" style="grid-column: span 2;">
                                <option value="16">/16</option>
                                <option value="8">/8</option>
                                <option value="4">/4</option>
                                <option value="2">/2</option>
                            </select>
                            
                            <!-- Separator -->
                            <div style="grid-column: span 5; text-align: center; font-size: 1.5rem; font-weight: bold; margin: 10px 0;">
                                ×
                            </div>
                            
                            <!-- Height -->
                            <input type="number" id="actualHeightFeet" placeholder="Feet" value="3">
                            <span>ft</span>
                            <input type="number" id="actualHeightInches" placeholder="Inches" value="0" min="0" max="11">
                            <span>in</span>
                            <input type="number" id="actualHeightFraction" placeholder="Fraction" value="0" min="0" max="15" step="1">
                            <select id="actualHeightFractionType" style="grid-column: span 2;">
                                <option value="16">/16</option>
                                <option value="8">/8</option>
                                <option value="4">/4</option>
                                <option value="2">/2</option>
                            </select>
                        </div>
                        
                        <!-- MM Input (Hidden by Default) -->
                        <div id="mmInput" class="mm-input" style="display: none;">
                            <!-- Width -->
                            <div style="flex: 1;">
                                <input type="number" id="actualWidthMM" placeholder="Width in mm" value="1219.2">
                                <div class="conversion-display" id="actualWidthMMtoInches">
                                    48.0 inches (4' 0")
                                </div>
                            </div>
                            
                            <div style="display: flex; align-items: center; font-size: 1.5rem; font-weight: bold; padding: 0 10px;">
                                ×
                            </div>
                            
                            <!-- Height -->
                            <div style="flex: 1;">
                                <input type="number" id="actualHeightMM" placeholder="Height in mm" value="914.4">
                                <div class="conversion-display" id="actualHeightMMtoInches">
                                    36.0 inches (3' 0")
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chargeable Size -->
                    <div class="dimension-group">
                        <h3><i class="fas fa-calculator"></i> Chargeable Size</h3>
                        
                        <!-- Inches Input for Chargeable -->
                        <div id="chargeableInchesInput" class="inches-input">
                            <!-- Width -->
                            <input type="number" id="chargeWidthFeet" placeholder="Feet" value="4">
                            <span>ft</span>
                            <input type="number" id="chargeWidthInches" placeholder="Inches" value="0" min="0" max="11">
                            <span>in</span>
                            <input type="number" id="chargeWidthFraction" placeholder="Fraction" value="8" min="0" max="15" step="1">
                            <select id="chargeWidthFractionType" style="grid-column: span 2;">
                                <option value="16">/16</option>
                                <option value="8">/8</option>
                                <option value="4">/4</option>
                                <option value="2">/2</option>
                            </select>
                            
                            <!-- Separator -->
                            <div style="grid-column: span 5; text-align: center; font-size: 1.5rem; font-weight: bold; margin: 10px 0;">
                                ×
                            </div>
                            
                            <!-- Height -->
                            <input type="number" id="chargeHeightFeet" placeholder="Feet" value="3">
                            <span>ft</span>
                            <input type="number" id="chargeHeightInches" placeholder="Inches" value="0" min="0" max="11">
                            <span>in</span>
                            <input type="number" id="chargeHeightFraction" placeholder="Fraction" value="4" min="0" max="15" step="1">
                            <select id="chargeHeightFractionType" style="grid-column: span 2;">
                                <option value="16">/16</option>
                                <option value="8">/8</option>
                                <option value="4">/4</option>
                                <option value="2">/2</option>
                            </select>
                        </div>
                        
                        <!-- MM Input for Chargeable (Hidden) -->
                        <div id="chargeableMMInput" class="mm-input" style="display: none;">
                            <!-- Width -->
                            <div style="flex: 1;">
                                <input type="number" id="chargeWidthMM" placeholder="Width in mm" value="1231.9">
                                <div class="conversion-display" id="chargeWidthMMtoInches">
                                    48.5 inches (4' 0½")
                                </div>
                            </div>
                            
                            <div style="display: flex; align-items: center; font-size: 1.5rem; font-weight: bold; padding: 0 10px;">
                                ×
                            </div>
                            
                            <!-- Height -->
                            <div style="flex: 1;">
                                <input type="number" id="chargeHeightMM" placeholder="Height in mm" value="920.75">
                                <div class="conversion-display" id="chargeHeightMMtoInches">
                                    36.25 inches (3' 0¼")
                                </div>
                            </div>
                        </div>
                        
                        <!-- Total Area Display -->
                        <div class="conversion-display" style="margin-top: 15px; background: #fff3cd; color: #856404;">
                            <i class="fas fa-chart-area"></i>
                            Total Area: <span id="totalArea">12.17</span> sq.ft
                            (<span id="totalAreaM2">1.13</span> m²)
                        </div>
                    </div>
                </div>
                
                <!-- Add Item Button -->
                <div style="text-align: center; margin-top: 20px;">
                    <button class="main-btn btn-calculate" onclick="addItem()">
                        <i class="fas fa-plus"></i> Add to Invoice
                    </button>
                </div>
            </div>
            
            <!-- Items Table -->
            <div class="items-table-container">
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Item Description</th>
                            <th>Actual Size</th>
                            <th>Chargeable Size</th>
                            <th>Qty</th>
                            <th>Area (sq.ft)</th>
                            <th>Rate (₹/sq.ft)</th>
                            <th>Amount (₹)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody">
                        <!-- Items will be added here dynamically -->
                    </tbody>
                </table>
            </div>
            
            <!-- Totals Section -->
            <div class="totals-section">
                <h3 style="color: var(--primary); margin-bottom: 20px;">
                    <i class="fas fa-calculator"></i> Invoice Summary
                </h3>
                
                <div class="totals-grid">
                    <div>
                        <div class="total-item">
                            <span>Total Items:</span>
                            <span id="totalItems">0</span>
                        </div>
                        <div class="total-item">
                            <span>Total Area:</span>
                            <span id="totalAreaSum">0.00</span> sq.ft
                        </div>
                        <div class="total-item">
                            <span>Subtotal:</span>
                            <span id="subtotal">₹0.00</span>
                        </div>
                    </div>
                    
                    <div>
                        <div class="total-item">
                            <span>GST @18%:</span>
                            <span id="gstAmount">₹0.00</span>
                        </div>
                        <div class="total-item">
                            <span>Other Charges:</span>
                            <span id="otherCharges">₹0.00</span>
                        </div>
                        <div class="total-item grand-total">
                            <span>GRAND TOTAL:</span>
                            <span id="grandTotal">₹0.00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="main-btn btn-save" onclick="saveInvoice()">
                    <i class="fas fa-save"></i> Save Proforma
                </button>
                <button class="main-btn btn-print" onclick="printInvoice()">
                    <i class="fas fa-print"></i> Print Invoice
                </button>
                <button class="main-btn btn-calculate" onclick="calculateAll()">
                    <i class="fas fa-calculator"></i> Calculate All
                </button>
            </div>
            
            <!-- Footer -->
            <div class="footer">
                <p>© 2024 GlassERP Pro - Professional Proforma Invoice System</p>
                <p>Supports Inches (Feet-Inches-Fractions) and Millimeters | Auto Conversion | Powered by <strong>S.A.P.U.T</strong></p>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        let items = [];
        let itemCounter = 1;
        
        // Set Active Unit
        function setActiveUnit(unit) {
            const inchesBtns = document.querySelectorAll('.unit-btn');
            inchesBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (unit === 'inches') {
                document.getElementById('inchesInput').style.display = 'grid';
                document.getElementById('mmInput').style.display = 'none';
                document.getElementById('chargeableInchesInput').style.display = 'grid';
                document.getElementById('chargeableMMInput').style.display = 'none';
            } else {
                document.getElementById('inchesInput').style.display = 'none';
                document.getElementById('mmInput').style.display = 'flex';
                document.getElementById('chargeableInchesInput').style.display = 'none';
                document.getElementById('chargeableMMInput').style.display = 'flex';
            }
            
            updateConversions();
        }
        
        // Convert Inches to Decimal
        function inchesToDecimal(feet, inches, fraction, fractionType) {
            feet = parseFloat(feet) || 0;
            inches = parseFloat(inches) || 0;
            fraction = parseFloat(fraction) || 0;
            fractionType = parseFloat(fractionType) || 16;
            
            const totalInches = (feet * 12) + inches + (fraction / fractionType);
            return totalInches;
        }
        
        // Convert Decimal Inches to Feet-Inches-Fraction
        function decimalToFeetInches(decimalInches) {
            const feet = Math.floor(decimalInches / 12);
            const remainingInches = decimalInches % 12;
            const wholeInches = Math.floor(remainingInches);
            const fractionInches = remainingInches - wholeInches;
            
            // Convert fraction to nearest 1/16
            let fraction = Math.round(fractionInches * 16);
            if (fraction === 16) {
                fraction = 0;
                wholeInches += 1;
            }
            
            return {
                feet: feet,
                inches: wholeInches,
                fraction: fraction,
                fractionType: 16
            };
        }
        
        // Convert Inches to MM
        function inchesToMM(inches) {
            return inches * 25.4;
        }
        
        // Convert MM to Inches
        function mmToInches(mm) {
            return mm / 25.4;
        }
        
        // Calculate Area in sq.ft
        function calculateArea(widthInches, heightInches) {
            const areaSqIn = widthInches * heightInches;
            return areaSqIn / 144; // Convert to sq.ft
        }
        
        // Update Conversions
        function updateConversions() {
            // Actual Size Conversions
            const actualWidthInches = inchesToDecimal(
                document.getElementById('actualWidthFeet').value,
                document.getElementById('actualWidthInches').value,
                document.getElementById('actualWidthFraction').value,
                document.getElementById('actualWidthFractionType').value
            );
            
            const actualHeightInches = inchesToDecimal(
                document.getElementById('actualHeightFeet').value,
                document.getElementById('actualHeightInches').value,
                document.getElementById('actualHeightFraction').value,
                document.getElementById('actualHeightFractionType').value
            );
            
            const actualWidthMM = inchesToMM(actualWidthInches);
            const actualHeightMM = inchesToMM(actualHeightInches);
            
            // Update MM inputs
            document.getElementById('actualWidthMM').value = actualWidthMM.toFixed(2);
            document.getElementById('actualHeightMM').value = actualHeightMM.toFixed(2);
            
            // Update MM to Inches display
            document.getElementById('actualWidthMMtoInches').textContent = 
                `${actualWidthInches.toFixed(2)}" (${Math.floor(actualWidthInches/12)}' ${(actualWidthInches%12).toFixed(2)}")`;
            
            document.getElementById('actualHeightMMtoInches').textContent = 
                `${actualHeightInches.toFixed(2)}" (${Math.floor(actualHeightInches/12)}' ${(actualHeightInches%12).toFixed(2)}")`;
            
            // Chargeable Size Conversions
            const chargeWidthInches = inchesToDecimal(
                document.getElementById('chargeWidthFeet').value,
                document.getElementById('chargeWidthInches').value,
                document.getElementById('chargeWidthFraction').value,
                document.getElementById('chargeWidthFractionType').value
            );
            
            const chargeHeightInches = inchesToDecimal(
                document.getElementById('chargeHeightFeet').value,
                document.getElementById('chargeHeightInches').value,
                document.getElementById('chargeHeightFraction').value,
                document.getElementById('chargeHeightFractionType').value
            );
            
            const chargeWidthMM = inchesToMM(chargeWidthInches);
            const chargeHeightMM = inchesToMM(chargeHeightInches);
            
            // Update MM inputs for chargeable
            document.getElementById('chargeWidthMM').value = chargeWidthMM.toFixed(2);
            document.getElementById('chargeHeightMM').value = chargeHeightMM.toFixed(2);
            
            // Update MM to Inches display for chargeable
            const chargeWidthFeetInches = decimalToFeetInches(chargeWidthInches);
            const chargeHeightFeetInches = decimalToFeetInches(chargeHeightInches);
            
            document.getElementById('chargeWidthMMtoInches').textContent = 
                `${chargeWidthInches.toFixed(2)}" (${chargeWidthFeetInches.feet}' ${chargeWidthFeetInches.inches}${chargeWidthFeetInches.fraction ? ' ' + chargeWidthFeetInches.fraction + '/16' : ''}")`;
            
            document.getElementById('chargeHeightMMtoInches').textContent = 
                `${chargeHeightInches.toFixed(2)}" (${chargeHeightFeetInches.feet}' ${chargeHeightFeetInches.inches}${chargeHeightFeetInches.fraction ? ' ' + chargeHeightFeetInches.fraction + '/16' : ''}")`;
            
            // Calculate and display total area
            const areaSqFt = calculateArea(chargeWidthInches, chargeHeightInches);
            const areaM2 = areaSqFt * 0.092903;
            
            document.getElementById('totalArea').textContent = areaSqFt.toFixed(2);
            document.getElementById('totalAreaM2').textContent = areaM2.toFixed(2);
            
            return {
                actualWidthInches,
                actualHeightInches,
                chargeWidthInches,
                chargeHeightInches,
                areaSqFt
            };
        }
        
        // Add event listeners to all inputs
        function setupEventListeners() {
            const inputs = [
                'actualWidthFeet', 'actualWidthInches', 'actualWidthFraction', 'actualWidthFractionType',
                'actualHeightFeet', 'actualHeightInches', 'actualHeightFraction', 'actualHeightFractionType',
                'chargeWidthFeet', 'chargeWidthInches', 'chargeWidthFraction', 'chargeWidthFractionType',
                'chargeHeightFeet', 'chargeHeightInches', 'chargeHeightFraction', 'chargeHeightFractionType',
                'actualWidthMM', 'actualHeightMM', 'chargeWidthMM', 'chargeHeightMM'
            ];
            
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', handleInputChange);
                }
            });
        }
        
        // Handle input changes
        function handleInputChange(event) {
            const id = event.target.id;
            
            // If MM input changed
            if (id.includes('MM')) {
                const mmValue = parseFloat(event.target.value) || 0;
                const inchesValue = mmToInches(mmValue);
                const feetInches = decimalToFeetInches(inchesValue);
                
                // Update corresponding inches inputs
                if (id === 'actualWidthMM') {
                    document.getElementById('actualWidthFeet').value = feetInches.feet;
                    document.getElementById('actualWidthInches').value = feetInches.inches;
                    document.getElementById('actualWidthFraction').value = feetInches.fraction;
                } else if (id === 'actualHeightMM') {
                    document.getElementById('actualHeightFeet').value = feetInches.feet;
                    document.getElementById('actualHeightInches').value = feetInches.inches;
                    document.getElementById('actualHeightFraction').value = feetInches.fraction;
                } else if (id === 'chargeWidthMM') {
                    document.getElementById('chargeWidthFeet').value = feetInches.feet;
                    document.getElementById('chargeWidthInches').value = feetInches.inches;
                    document.getElementById('chargeWidthFraction').value = feetInches.fraction;
                } else if (id === 'chargeHeightMM') {
                    document.getElementById('chargeHeightFeet').value = feetInches.feet;
                    document.getElementById('chargeHeightInches').value = feetInches.inches;
                    document.getElementById('chargeHeightFraction').value = feetInches.fraction;
                }
            }
            
            updateConversions();
        }
        
        // Add item to invoice
        function addItem() {
            const desc = document.getElementById('itemDesc').value;
            const qty = parseInt(document.getElementById('itemQty').value) || 1;
            const rate = parseFloat(document.getElementById('itemRate').value) || 0;
            
            const dimensions = updateConversions();
            
            const item = {
                id: itemCounter++,
                description: desc || `Glass Item ${itemCounter}`,
                actualWidth: dimensions.actualWidthInches,
                actualHeight: dimensions.actualHeightInches,
                chargeWidth: dimensions.chargeWidthInches,
                chargeHeight: dimensions.chargeHeightInches,
                quantity: qty,
                rate: rate,
                area: dimensions.areaSqFt,
                amount: dimensions.areaSqFt * rate * qty
            };
            
            items.push(item);
            updateItemsTable();
            calculateTotals();
            
            // Reset form
            document.getElementById('itemDesc').value = '';
            document.getElementById('itemQty').value = 1;
            document.getElementById('itemRate').value = 450;
            
            alert('Item added successfully!');
        }
        
        // Update items table
        function updateItemsTable() {
            const tbody = document.getElementById('itemsTableBody');
            tbody.innerHTML = '';
            
            items.forEach((item, index) => {
                const actualFeetInches = decimalToFeetInches(item.actualWidth);
                const actualFeetInchesH = decimalToFeetInches(item.actualHeight);
                const chargeFeetInches = decimalToFeetInches(item.chargeWidth);
                const chargeFeetInchesH = decimalToFeetInches(item.chargeHeight);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.description}</td>
                    <td class="size-display">
                        ${actualFeetInches.feet}' ${actualFeetInches.inches}${actualFeetInches.fraction ? ' ' + actualFeetInches.fraction + '/16' : ''}"<br>
                        <small>× ${actualFeetInchesH.feet}' ${actualFeetInchesH.inches}${actualFeetInchesH.fraction ? ' ' + actualFeetInchesH.fraction + '/16' : ''}"</small>
                    </td>
                    <td class="size-display">
                        ${chargeFeetInches.feet}' ${chargeFeetInches.inches}${chargeFeetInches.fraction ? ' ' + chargeFeetInches.fraction + '/16' : ''}"<br>
                        <small>× ${chargeFeetInchesH.feet}' ${chargeFeetInchesH.inches}${chargeFeetInchesH.fraction ? ' ' + chargeFeetInchesH.fraction + '/16' : ''}"</small>
                    </td>
                    <td>${item.quantity}</td>
                    <td>${item.area.toFixed(2)}</td>
                    <td>₹${item.rate.toFixed(2)}</td>
                    <td>₹${item.amount.toFixed(2)}</td>
                    <td>
                        <div class="action-btns">
                            <button class="icon-btn btn-view" onclick="viewItem(${item.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="icon-btn btn-edit" onclick="editItem(${item.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="icon-btn btn-delete" onclick="deleteItem(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // Calculate totals
        function calculateTotals() {
            const totalItems = items.length;
            const totalArea = items.reduce((sum, item) => sum + (item.area * item.quantity), 0);
            const subtotal = items.reduce((sum, item) => sum + item.amount, 0);
            const gst = subtotal * 0.18;
            const grandTotal = subtotal + gst;
            
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('totalAreaSum').textContent = totalArea.toFixed(2);
            document.getElementById('subtotal').textContent = `₹${subtotal.toFixed(2)}`;
            document.getElementById('gstAmount').textContent = `₹${gst.toFixed(2)}`;
            document.getElementById('grandTotal').textContent = `₹${grandTotal.toFixed(2)}`;
        }
        
        // View item
        function viewItem(id) {
            const item = items.find(i => i.id === id);
            if (item) {
                alert(`Item: ${item.description}\nSize: ${item.chargeWidth.toFixed(2)}" × ${item.chargeHeight.toFixed(2)}"\nArea: ${item.area.toFixed(2)} sq.ft\nAmount: ₹${item.amount.toFixed(2)}`);
            }
        }
        
        // Edit item
        function editItem(id) {
            const item = items.find(i => i.id === id);
            if (item) {
                if (confirm(`Edit item: ${item.description}?`)) {
                    // Set form values
                    document.getElementById('itemDesc').value = item.description;
                    document.getElementById('itemQty').value = item.quantity;
                    document.getElementById('itemRate').value = item.
