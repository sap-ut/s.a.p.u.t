<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.A.P.U.T. Glass Works Enterprise - Complete ERP System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #2979ff;
            --success: #00c853;
            --warning: #ff9100;
            --danger: #ff1744;
            --info: #00b8d4;
            --glass: #e3f2fd;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            font-size: 13px;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .main-container {
            padding: 15px;
            min-height: 100vh;
        }
        
        /* HEADER */
        .header-bar {
            background: linear-gradient(135deg, var(--primary), #283593);
            padding: 12px 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            color: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* DASHBOARD GRID - COMPLETE */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .module-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            text-align: center;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: var(--secondary);
        }
        
        .module-card i {
            font-size: 32px;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .module-card h6 {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
            margin: 0 0 5px 0;
        }
        
        .module-card .shortcut {
            font-size: 11px;
            color: #666;
            margin-top: 5px;
            font-family: monospace;
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
        }
        
        /* PROFORMA PAGE */
        .proforma-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        
        /* CUSTOMER FORM */
        .customer-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .section-header {
            font-size: 15px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* PRODUCT TABLE - EXCEL STYLE */
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 2000px;
        }
        
        .data-table thead {
            background: linear-gradient(135deg, var(--primary), #3949ab);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .data-table th {
            padding: 12px 8px;
            font-weight: 600;
            text-align: center;
            border-right: 1px solid rgba(255,255,255,0.1);
            white-space: nowrap;
            font-size: 11px;
        }
        
        .data-table td {
            padding: 8px;
            border: 1px solid #e0e0e0;
            text-align: center;
            vertical-align: middle;
            height: 40px;
        }
        
        .data-table input, 
        .data-table select {
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px;
            font-size: 12px;
            height: 32px;
            background: white;
        }
        
        /* GLASS TYPE QUICK KEYS PANEL */
        .glass-keys-panel {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            width: 250px;
            border: 2px solid var(--primary);
        }
        
        .glass-key-btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            margin-bottom: 5px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .glass-key-btn:hover {
            background: #e3f2fd;
            border-color: var(--secondary);
        }
        
        .key-shortcut {
            background: #6c757d;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-family: monospace;
        }
        
        /* CHARGES PANEL */
        .charges-panel {
            background: linear-gradient(135deg, #f8f9fa, #e8eaf6);
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .charges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .charge-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* TOTAL SECTION */
        .total-section {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }
        
        .total-row:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 16px;
            color: var(--primary);
        }
        
        /* ORDER MANAGEMENT */
        .order-status-bar {
            display: flex;
            background: white;
            border-radius: 25px;
            padding: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .status-step {
            flex: 1;
            text-align: center;
            padding: 10px;
            position: relative;
        }
        
        .status-step.active {
            background: var(--secondary);
            color: white;
            border-radius: 20px;
        }
        
        /* DISPATCH PLANNER */
        .dispatch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        /* OPTIMIZATION */
        .optimization-view {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            height: 600px;
        }
        
        .glass-sheet {
            background: #e3f2fd;
            border: 2px dashed #1976d2;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        /* CUSTOM CHARGES MASTER */
        .custom-master-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        /* PRINT MULTI-PAGE */
        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }
            
            .no-print, .header-bar, .glass-keys-panel {
                display: none !important;
            }
            
            body {
                background: white !important;
            }
            
            .print-page {
                page-break-after: always;
                border: 1px solid #000;
                padding: 10mm;
                margin-bottom: 10mm;
                position: relative;
            }
            
            .copy-number {
                position: absolute;
                top: 5mm;
                right: 10mm;
                font-size: 14px;
                font-weight: bold;
                color: #000;
            }
            
            .watermark {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(-45deg);
                font-size: 80px;
                color: rgba(0,0,0,0.1);
                z-index: 999;
            }
        }
        
        /* GLASS LINE INDICATORS */
        .line-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            margin: 1px;
        }
        
        .indicator-c { background: #e8eaf6; color: #3f51b5; }
        .indicator-p { background: #f3e5f5; color: #8e24aa; }
        .indicator-f { background: #e0f2f1; color: #00796b; }
        .indicator-w { background: #fff3e0; color: #f57c00; }
        .indicator-b { background: #e8f5e9; color: #388e3c; }
        .indicator-t { background: #fff8e1; color: #ff8f00; }
        .indicator-l { background: #fce4ec; color: #c2185b; }
        .indicator-dg { background: #e1f5fe; color: #0277bd; }
        .indicator-rd { background: #f1f8e9; color: #689f38; }
        .indicator-d { background: #fffde7; color: #f9a825; }
        
        /* FLOATING ACTIONS */
        .float-actions {
            position: fixed;
            bottom: 100px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        .action-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            transform: scale(1.1);
        }
        
        /* UTILITIES */
        .text-sm { font-size: 12px; }
        .text-xs { font-size: 11px; }
        .fw-600 { font-weight: 600; }
        .cursor-pointer { cursor: pointer; }
        .w-100 { width: 100%; }
        .mb-1 { margin-bottom: 5px; }
        .mb-2 { margin-bottom: 10px; }
        .mb-3 { margin-bottom: 15px; }
        .mt-1 { margin-top: 5px; }
        .mt-2 { margin-top: 10px; }
        .mt-3 { margin-top: 15px; }
    </style>
</head>
<body>
    <!-- GLASS TYPE QUICK KEYS PANEL -->
    <div class="glass-keys-panel glass-effect">
        <h6 class="mb-3"><i class="fas fa-keyboard me-2"></i>Glass Type Shortcuts</h6>
        <div class="mb-2">
            <div class="glass-key-btn" onclick="setGlassType('C')" data-key="C">
                <span><i class="fas fa-square text-info me-2"></i>Clear Glass</span>
                <kbd class="key-shortcut">Ctrl+1</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('P')" data-key="P">
                <span><i class="fas fa-th-large text-warning me-2"></i>Patterned</span>
                <kbd class="key-shortcut">Ctrl+2</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('F')" data-key="F">
                <span><i class="fas fa-snowflake text-primary me-2"></i>Frosted</span>
                <kbd class="key-shortcut">Ctrl+3</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('T')" data-key="T">
                <span><i class="fas fa-shield-alt text-success me-2"></i>Toughened</span>
                <kbd class="key-shortcut">Ctrl+4</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('L')" data-key="L">
                <span><i class="fas fa-layer-group text-danger me-2"></i>Laminated</span>
                <kbd class="key-shortcut">Ctrl+5</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('DG')" data-key="DG">
                <span><i class="fas fa-window-restore text-info me-2"></i>Double Glazed</span>
                <kbd class="key-shortcut">Ctrl+6</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('W')" data-key="W">
                <span><i class="fas fa-border-style text-secondary me-2"></i>Wired</span>
                <kbd class="key-shortcut">Ctrl+7</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('B')" data-key="B">
                <span><i class="fas fa-palette text-warning me-2"></i>Body Tinted</span>
                <kbd class="key-shortcut">Ctrl+8</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('RD')" data-key="RD">
                <span><i class="fas fa-sun text-danger me-2"></i>Reflective</span>
                <kbd class="key-shortcut">Ctrl+9</kbd>
            </div>
            <div class="glass-key-btn" onclick="setGlassType('D')" data-key="D">
                <span><i class="fas fa-paint-brush text-success me-2"></i>Designer</span>
                <kbd class="key-shortcut">Ctrl+0</kbd>
            </div>
        </div>
        <div class="text-xs text-muted">
            <i class="fas fa-info-circle me-1"></i>
            Click or use shortcut keys
        </div>
    </div>

    <!-- FLOATING ACTIONS -->
    <div class="float-actions">
        <button class="action-btn" style="background: linear-gradient(135deg, #4CAF50, #2E7D32);" 
                onclick="addNewRow()" title="Add Row (Insert)">
            <i class="fas fa-plus"></i>
        </button>
        <button class="action-btn" style="background: linear-gradient(135deg, #2196F3, #0D47A1);" 
                onclick="calculateAll()" title="Calculate All (F9)">
            <i class="fas fa-calculator"></i>
        </button>
        <button class="action-btn" style="background: linear-gradient(135deg, #FF9800, #E65100);" 
                onclick="printProforma()" title="Print (Ctrl+P)">
            <i class="fas fa-print"></i>
        </button>
        <button class="action-btn" style="background: linear-gradient(135deg, #9C27B0, #4A148C);" 
                onclick="showShortcutsHelp()" title="Shortcuts (F1)">
            <i class="fas fa-keyboard"></i>
        </button>
    </div>

    <!-- MAIN CONTAINER -->
    <div class="main-container" id="mainContent">
        <!-- HEADER -->
        <div class="header-bar glass-effect">
            <div class="d-flex align-items-center">
                <div class="glass-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #e3f2fd, #bbdefb); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 10px; color: #1565c0; font-size: 20px;">
                    <i class="fas fa-industry"></i>
                </div>
                <div>
                    <h5 class="mb-0">S.A.P.U.T. GLASS WORKS ENTERPRISE</h5>
                    <div class="text-sm">Complete Glass Manufacturing ERP</div>
                </div>
            </div>
            <div class="d-flex align-items-center gap-3">
                <div class="text-sm">
                    <i class="fas fa-user me-1"></i>
                    <span>Admin</span>
                </div>
                <button class="btn btn-sm btn-light" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- DASHBOARD SECTION -->
        <div id="dashboardSection">
            <div class="dashboard-grid">
                <!-- PROFORMA & QUOTATION -->
                <div class="module-card" onclick="showProforma()">
                    <i class="fas fa-file-invoice-dollar fa-2x"></i>
                    <h6>Create Proforma</h6>
                    <p class="text-xs text-muted mt-1">Create proforma invoices</p>
                    <div class="shortcut">Ctrl+P</div>
                </div>
                
                <div class="module-card" onclick="showQuotation()">
                    <i class="fas fa-file-alt fa-2x"></i>
                    <h6>Create Quotation</h6>
                    <p class="text-xs text-muted mt-1">Generate quotations</p>
                    <div class="shortcut">Ctrl+Q</div>
                </div>
                
                <!-- CUSTOMER MANAGEMENT -->
                <div class="module-card" onclick="showCustomerManagement()">
                    <i class="fas fa-users fa-2x"></i>
                    <h6>Customers Management</h6>
                    <p class="text-xs text-muted mt-1">Manage customers</p>
                    <div class="shortcut">Ctrl+C</div>
                </div>
                
                <!-- ACCOUNTING -->
                <div class="module-card" onclick="showAccounting()">
                    <i class="fas fa-calculator fa-2x"></i>
                    <h6>Accounting</h6>
                    <p class="text-xs text-muted mt-1">Accounts & Ledger</p>
                    <div class="shortcut">Ctrl+A</div>
                </div>
                
                <!-- ATTENDANCE -->
                <div class="module-card" onclick="showAttendance()">
                    <i class="fas fa-calendar-check fa-2x"></i>
                    <h6>Attendance</h6>
                    <p class="text-xs text-muted mt-1">Employee attendance</p>
                    <div class="shortcut">Ctrl+T</div>
                </div>
                
                <!-- ITEM MASTER -->
                <div class="module-card" onclick="showItemMaster()">
                    <i class="fas fa-box fa-2x"></i>
                    <h6>Item Master</h6>
                    <p class="text-xs text-muted mt-1">Manage products</p>
                    <div class="shortcut">Ctrl+I</div>
                </div>
                
                <!-- USER MANAGEMENT -->
                <div class="module-card" onclick="showUserManagement()">
                    <i class="fas fa-user-cog fa-2x"></i>
                    <h6>User Management</h6>
                    <p class="text-xs text-muted mt-1">Create users</p>
                    <div class="shortcut">Ctrl+U</div>
                </div>
                
                <!-- ADMIN PANEL -->
                <div class="module-card" onclick="showAdminPanel()">
                    <i class="fas fa-shield-alt fa-2x"></i>
                    <h6>Admin Panel</h6>
                    <p class="text-xs text-muted mt-1">System administration</p>
                    <div class="shortcut">Ctrl+Shift+A</div>
                </div>
                
                <!-- REPORTS -->
                <div class="module-card" onclick="showReports()">
                    <i class="fas fa-chart-bar fa-2x"></i>
                    <h6>Reports</h6>
                    <p class="text-xs text-muted mt-1">View reports</p>
                    <div class="shortcut">Ctrl+R</div>
                </div>
                
                <!-- SETTINGS -->
                <div class="module-card" onclick="showSettings()">
                    <i class="fas fa-cog fa-2x"></i>
                    <h6>Settings</h6>
                    <p class="text-xs text-muted mt-1">System settings</p>
                    <div class="shortcut">Ctrl+S</div>
                </div>
                
                <!-- GST INVOICE -->
                <div class="module-card" onclick="showGSTInvoice()">
                    <i class="fas fa-file-invoice fa-2x"></i>
                    <h6>GST Invoice</h6>
                    <p class="text-xs text-muted mt-1">Create GST invoices</p>
                    <div class="shortcut">Ctrl+G</div>
                </div>
                
                <!-- ORDER MANAGEMENT -->
                <div class="module-card" onclick="showOrderManagement()">
                    <i class="fas fa-clipboard-list fa-2x"></i>
                    <h6>Order Management</h6>
                    <p class="text-xs text-muted mt-1">Manage orders</p>
                    <div class="shortcut">Ctrl+O</div>
                </div>
                
                <!-- DISPATCH PLANNER -->
                <div class="module-card" onclick="showDispatchPlanner()">
                    <i class="fas fa-truck-loading fa-2x"></i>
                    <h6>Dispatch Planner</h6>
                    <p class="text-xs text-muted mt-1">Plan deliveries</p>
                    <div class="shortcut">Ctrl+D</div>
                </div>
                
                <!-- OPTIMIZATION -->
                <div class="module-card" onclick="showOptimization()">
                    <i class="fas fa-cube fa-2x"></i>
                    <h6>Optimization</h6>
                    <p class="text-xs text-muted mt-1">Glass cutting optimization</p>
                    <div class="shortcut">Ctrl+X</div>
                </div>
                
                <!-- GLASS LINES -->
                <div class="module-card" onclick="showGlassLines()">
                    <i class="fas fa-th-large fa-2x"></i>
                    <h6>Glass Lines</h6>
                    <p class="text-xs text-muted mt-1">All glass types</p>
                    <div class="shortcut">Ctrl+L</div>
                </div>
                
                <!-- CUSTOM CHARGES MASTER -->
                <div class="module-card" onclick="showCustomChargesMaster()">
                    <i class="fas fa-coins fa-2x"></i>
                    <h6>Custom Charges</h6>
                    <p class="text-xs text-muted mt-1">Manage all charges</p>
                    <div class="shortcut">Ctrl+Shift+C</div>
                </div>
            </div>
        </div>

        <!-- PROFORMA SECTION -->
        <div id="proformaSection" style="display: none;">
            <div class="proforma-container glass-effect">
                <!-- CUSTOMER DETAILS -->
                <div class="customer-form">
                    <!-- BILL TO -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-user-tie me-2"></i>Bill To
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-12">
                                <select class="form-select form-select-sm" id="customerSelect" onchange="loadCustomer()">
                                    <option value="">Select Customer</option>
                                </select>
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-12">
                                <input type="text" class="form-control form-control-sm" id="billName" placeholder="Customer Name">
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-12">
                                <textarea class="form-control form-control-sm" id="billAddress" rows="2" placeholder="Address"></textarea>
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billCity" placeholder="City">
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billPincode" placeholder="Pincode">
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billState" placeholder="State">
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billGST" placeholder="GSTIN">
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billPhone" placeholder="Contact No.">
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="billSalesPerson" placeholder="Sales Person">
                            </div>
                        </div>
                    </div>
                    
                    <!-- SHIP TO -->
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-truck me-2"></i>Ship To
                            <div class="form-check form-check-inline float-end">
                                <input class="form-check-input" type="checkbox" id="sameAsBill" onchange="copyToShip()">
                                <label class="form-check-label text-sm">Same as Bill</label>
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-12">
                                <input type="text" class="form-control form-control-sm" id="shipName" placeholder="Customer Name">
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-12">
                                <textarea class="form-control form-control-sm" id="shipAddress" rows="2" placeholder="Address"></textarea>
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="shipCity" placeholder="City">
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="shipPincode" placeholder="Pincode">
                            </div>
                        </div>
                        <div class="row g-2 mb-2">
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="shipState" placeholder="State">
                            </div>
                            <div class="col-6">
                                <input type="text" class="form-control form-control-sm" id="shipGST" placeholder="GSTIN">
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-12">
                                <input type="text" class="form-control form-control-sm" id="shipPhone" placeholder="Contact No.">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- PRODUCT TABLE -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="30">#</th>
                                <th width="150">Type</th>
                                <th width="150">Item</th>
                                <th width="100">Actual Width (Inches)</th>
                                <th width="100">Actual Height (Inches)</th>
                                <th width="100">Chargable Width (MM)</th>
                                <th width="100">Chargable Height (MM)</th>
                                <th width="80">Qty</th>
                                <th width="100">Rate (₹/sq.ft)</th>
                                <th width="80">Hole Qty</th>
                                <th width="80">Cut Qty</th>
                                <th width="100">Area (Sq.Ft)</th>
                                <th width="100">Amount (₹)</th>
                                <th width="100">Remark</th>
                                <th width="40" class="no-print">Del</th>
                            </tr>
                        </thead>
                        <tbody id="productTable">
                            <!-- Rows will be added here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- OTHER CHARGES PANEL -->
                <div class="charges-panel">
                    <div class="charges-header">
                        <h6 class="mb-0"><i class="fas fa-receipt me-2"></i>Other Charges</h6>
                        <button class="btn btn-sm btn-success" onclick="addCharge()">
                            <i class="fas fa-plus me-1"></i> Add Charge
                        </button>
                    </div>
                    <div class="charges-grid" id="chargesGrid">
                        <!-- Charges will be added here -->
                    </div>
                </div>
                
                <!-- TOTALS -->
                <div class="total-section">
                    <div class="total-row">
                        <span>Basic Subtotal:</span>
                        <span id="basicSubtotal">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Hole Charges:</span>
                        <span id="holeCharges">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Cutout Charges:</span>
                        <span id="cutCharges">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Document Charges:</span>
                        <span id="docCharges">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Freight Charges:</span>
                        <span id="freightCharges">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Total Before Tax:</span>
                        <span id="totalBeforeTax">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>CGST (9%):</span>
                        <span id="cgstAmount">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>SGST (9%):</span>
                        <span id="sgstAmount">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span style="font-weight: 600;">GRAND TOTAL:</span>
                        <span id="grandTotal" style="font-size: 18px; color: #d32f2f;">₹0.00</span>
                    </div>
                </div>
                
                <!-- ACTION BUTTONS -->
                <div class="d-flex justify-content-between mt-3">
                    <div>
                        <button class="btn btn-primary me-2" onclick="saveProforma()">
                            <i class="fas fa-save me-1"></i> Save PI
                        </button>
                        <button class="btn btn-success me-2" onclick="printProforma()">
                            <i class="fas fa-print me-1"></i> Print
                        </button>
                        <button class="btn btn-warning" onclick="createGSTInvoice()">
                            <i class="fas fa-file-invoice me-1"></i> GST Invoice
                        </button>
                    </div>
                    <div>
                        <button class="btn btn-outline-secondary" onclick="showDashboard()">
                            <i class="fas fa-times me-1"></i> Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ORDER MANAGEMENT SECTION -->
        <div id="orderManagementSection" style="display: none;">
            <div class="proforma-container glass-effect">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4 class="mb-0"><i class="fas fa-clipboard-list me-2"></i>Order Management</h4>
                    <button class="btn btn-primary" onclick="addNewOrder()">
                        <i class="fas fa-plus me-1"></i> New Order
                    </button>
                </div>
                
                <!-- ORDER STATUS BAR -->
                <div class="order-status-bar mb-4">
                    <div class="status-step active">Draft</div>
                    <div class="status-step">Approved</div>
                    <div class="status-step">Production</div>
                    <div class="status-step">Dispatch</div>
                    <div class="status-step">Completed</div>
                </div>
                
                <!-- ORDERS TABLE -->
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead class="table-dark">
                            <tr>
                                <th>Order No.</th>
                                <th>Date</th>
                                <th>Customer</th>
                                <th>Glass Types</th>
                                <th>Qty</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTable">
                            <!-- Orders will load here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- GLASS LINES SECTION -->
        <div id="glassLinesSection" style="display: none;">
            <div class="proforma-container glass-effect">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4 class="mb-0"><i class="fas fa-th-large me-2"></i>Glass Lines & Systems</h4>
                    <div class="text-muted text-sm">
                        Total Systems: <span class="badge bg-primary">35</span>
                    </div>
                </div>
                
                <!-- GLASS LINES GRID -->
                <div class="custom-master-grid" id="glassLinesGrid">
                    <!-- Glass lines will be loaded here -->
                </div>
            </div>
        </div>

        <!-- CUSTOM CHARGES MASTER -->
        <div id="customChargesMasterSection" style="display: none;">
            <div class="proforma-container glass-effect">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="mb-0"><i class="fas fa-coins me-2"></i>Custom Charges Master</h5>
                    <button class="btn btn-primary" onclick="addNewCustomCharge()">
                        <i class="fas fa-plus me-1"></i> Create Custom Charge
                    </button>
                </div>
                
                <div class="custom-master-grid">
                    <!-- Predefined Charges -->
                    <div class="custom-charge-card" style="background: white; border-radius: 8px; padding: 15px; border: 1px solid #e0e0e0;">
                        <h6 class="fw-600 mb-2"><i class="fas fa-file-invoice-dollar me-2"></i>Documentation Charges</h6>
                        <div class="text-sm text-muted mb-2">For documentation and paperwork</div>
                        <div class="d-flex justify-content-between">
                            <span class="badge bg-primary">Fixed</span>
                            <button class="btn btn-xs btn-outline-primary" onclick="addChargeToPI('Documentation Charges')">
                                <i class="fas fa-plus"></i> Add to PI
                            </button>
                        </div>
                    </div>
                    
                    <!-- All other charges... -->
                </div>
            </div>
        </div>

        <!-- Add other sections similarly... -->

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // COMPLETE GLASS TYPE DATA
        const glassTypes = {
            'C': { // Clear Glass
                name: 'Clear Float Glass',
                items: [
                    { code: 'C-3MM', name: 'Clear 3mm', rate: 45 },
                    { code: 'C-4MM', name: 'Clear 4mm', rate: 55 },
                    { code: 'C-5MM', name: 'Clear 5mm', rate: 65 },
                    { code: 'C-6MM', name: 'Clear 6mm', rate: 75 },
                    { code: 'C-8MM', name: 'Clear 8mm', rate: 95 },
                    { code: 'C-10MM', name: 'Clear 10mm', rate: 125 },
                    { code: 'C-12MM', name: 'Clear 12mm', rate: 155 }
                ]
            },
            'P': { // Patterned
                name: 'Patterned Glass',
                items: [
                    { code: 'P-4MM', name: 'Patterned 4mm', rate: 85 },
                    { code: 'P-5MM', name: 'Patterned 5mm', rate: 95 },
                    { code: 'P-6MM', name: 'Patterned 6mm', rate: 105 }
                ]
            },
            'F': { // Frosted
                name: 'Frosted Glass',
                items: [
                    { code: 'F-4MM', name: 'Frosted 4mm', rate: 110 },
                    { code: 'F-5MM', name: 'Frosted 5mm', rate: 120 },
                    { code: 'F-6MM', name: 'Frosted 6mm', rate: 130 }
                ]
            },
            'T': { // Toughened
                name: 'Toughened Glass',
                items: [
                    { code: 'T-5MM', name: 'Toughened 5mm', rate: 155 },
                    { code: 'T-6MM', name: 'Toughened 6mm', rate: 175 },
                    { code: 'T-8MM', name: 'Toughened 8mm', rate: 205 },
                    { code: 'T-10MM', name: 'Toughened 10mm', rate: 245 },
                    { code: 'T-12MM', name: 'Toughened 12mm', rate: 295 }
                ]
            },
            'L': { // Laminated
                name: 'Laminated Glass',
                items: [
                    { code: 'L-6.38', name: 'Laminated 6.38mm', rate: 225 },
                    { code: 'L-8.38', name: 'Laminated 8.38mm', rate: 265 },
                    { code: 'L-10.38', name: 'Laminated 10.38mm', rate: 315 }
                ]
            },
            'DG': { // Double Glazed
                name: 'Double Glazed Unit',
                items: [
                    { code: 'DG-24MM', name: 'DGU 24mm', rate: 385 },
                    { code: 'DG-28MM', name: 'DGU 28mm', rate: 425 }
                ]
            },
            'W': { // Wired
                name: 'Wired Glass',
                items: [
                    { code: 'W-6MM', name: 'Wired 6mm', rate: 140 },
                    { code: 'W-8MM', name: 'Wired 8mm', rate: 160 }
                ]
            },
            'B': { // Body Tinted
                name: 'Body Tinted Glass',
                items: [
                    { code: 'B-5MM', name: 'Tinted 5mm Bronze', rate: 135 },
                    { code: 'B-6MM', name: 'Tinted 6mm Green', rate: 145 },
                    { code: 'B-8MM', name: 'Tinted 8mm Blue', rate: 165 },
                    { code: 'B-10MM', name: 'Tinted 10mm Grey', rate: 185 }
                ]
            },
            'RD': { // Reflective/Dyed
                name: 'Reflective Glass',
                items: [
                    { code: 'RD-6MM', name: 'Reflective 6mm Blue', rate: 195 },
                    { code: 'RD-8MM', name: 'Reflective 8mm Silver', rate: 225 },
                    { code: 'RD-DYE', name: 'Dyed Glass 6mm', rate: 185 }
                ]
            },
            'D': { // Designer
                name: 'Designer Glass',
                items: [
                    { code: 'D-ETCH', name: 'Etched Designer', rate: 325 },
                    { code: 'D-BACK', name: 'Backpainted Glass', rate: 285 },
                    { code: 'D-PRINT', name: 'Digital Print Glass', rate: 450 }
                ]
            }
        };

        // VARIABLES
        let currentRow = 1;
        let currentGlassType = 'C';
        let customers = [];
        let orders = [];
        
        // INITIALIZE
        document.addEventListener('DOMContentLoaded', function() {
            showDashboard();
            setupKeyboardShortcuts();
            loadCustomers();
            addNewRow();
        });
        
        // KEYBOARD SHORTCUTS
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                // Function Keys
                if (e.key === 'F1') {
                    e.preventDefault();
                    showShortcutsHelp();
                }
                if (e.key === 'F9') {
                    e.preventDefault();
                    calculateAll();
                }
                if (e.key === 'Insert' || e.key === 'Ins') {
                    e.preventDefault();
                    addNewRow();
                }
                
                // Ctrl + Number (1-0) for Glass Types
                if (e.ctrlKey && !e.altKey && !e.shiftKey) {
                    const key = e.key;
                    switch(key) {
                        case '1': e.preventDefault(); setGlassType('C'); break;
                        case '2': e.preventDefault(); setGlassType('P'); break;
                        case '3': e.preventDefault(); setGlassType('F'); break;
                        case '4': e.preventDefault(); setGlassType('T'); break;
                        case '5': e.preventDefault(); setGlassType('L'); break;
                        case '6': e.preventDefault(); setGlassType('DG'); break;
                        case '7': e.preventDefault(); setGlassType('W'); break;
                        case '8': e.preventDefault(); setGlassType('B'); break;
                        case '9': e.preventDefault(); setGlassType('RD'); break;
                        case '0': e.preventDefault(); setGlassType('D'); break;
                        
                        // Navigation Shortcuts
                        case 'p': case 'P': e.preventDefault(); showProforma(); break;
                        case 'o': case 'O': e.preventDefault(); showOrderManagement(); break;
                        case 'g': case 'G': e.preventDefault(); showGSTInvoice(); break;
                        case 'q': case 'Q': e.preventDefault(); showQuotation(); break;
                        case 'c': case 'C': e.preventDefault(); showCustomerManagement(); break;
                        case 'a': case 'A': e.preventDefault(); showAccounting(); break;
                        case 'i': case 'I': e.preventDefault(); showItemMaster(); break;
                        case 'l': case 'L': e.preventDefault(); showGlassLines(); break;
                        case 'd': case 'D': e.preventDefault(); showDispatchPlanner(); break;
                        case 'r': case 'R': e.preventDefault(); showReports(); break;
                        case 's': case 'S': e.preventDefault(); showSettings(); break;
                        case 'u': case 'U': e.preventDefault(); showUserManagement(); break;
                    }
                }
                
                // Print Shortcut
                if (e.ctrlKey && (e.key === 'p' || e.key === 'P')) {
                    e.preventDefault();
                    printProforma();
                }
            });
        }
        
        // NAVIGATION FUNCTIONS
        function showDashboard() {
            hideAllSections();
            document.getElementById('dashboardSection').style.display = 'block';
        }
        
        function showProforma() {
            hideAllSections();
            document.getElementById('proformaSection').style.display = 'block';
            document.querySelector('.glass-keys-panel').style.display = 'block';
        }
        
        function showOrderManagement() {
            hideAllSections();
            document.getElementById('orderManagementSection').style.display = 'block';
        }
        
        function showGlassLines() {
            hideAllSections();
            document.getElementById('glassLinesSection').style.display = 'block';
            loadGlassLines();
        }
        
        function showCustomChargesMaster() {
            hideAllSections();
            document.getElementById('customChargesMasterSection').style.display = 'block';
        }
        
        // Add other show functions...
        function showQuotation() { alert('Quotation Module'); }
        function showCustomerManagement() { alert('Customer Management'); }
        function showAccounting() { alert('Accounting Module'); }
        function showAttendance() { alert('Attendance Module'); }
        function showItemMaster() { alert('Item Master'); }
        function showUserManagement() { alert('User Management'); }
        function showAdminPanel() { alert('Admin Panel'); }
        function showReports() { alert('Reports Module'); }
        function showSettings() { alert('Settings Module'); }
        function showGSTInvoice() { alert('GST Invoice Module'); }
        function showDispatchPlanner() { alert('Dispatch Planner'); }
        function showOptimization() { alert('Optimization Module'); }
        
        function hideAllSections() {
            const sections = [
                'dashboardSection',
                'proformaSection',
                'orderManagementSection',
                'glassLinesSection',
                'customChargesMasterSection'
            ];
            
            sections.forEach(section => {
                document.getElementById(section).style.display = 'none';
            });
            
            document.querySelector('.glass-keys-panel').style.display = 'none';
        }
        
        // SET GLASS TYPE
        function setGlassType(type) {
            currentGlassType = type;
            
            // Highlight button
            document.querySelectorAll('.glass-key-btn').forEach(btn => {
                btn.style.background = btn.dataset.key === type ? '#e3f2fd' : '';
                btn.style.borderColor = btn.dataset.key === type ? '#2196f3' : '#dee2e6';
            });
            
            showNotification(`Glass type set to: ${glassTypes[type].name}`);
            
            // Update current row if focused
            const activeRow = document.querySelector('tr input:focus')?.closest('tr');
            if (activeRow) {
                const typeCell = activeRow.querySelector('td:nth-child(2)');
                const itemCell = activeRow.querySelector('td:nth-child(3) select');
                
                if (typeCell && itemCell) {
                    const indicatorClass = `indicator-${type.toLowerCase()}`;
                    typeCell.innerHTML = `<span class="line-indicator ${indicatorClass}">${type}</span> ${glassTypes[type].name}`;
                    
                    // Update item dropdown
                    itemCell.innerHTML = '<option value="">Select Item</option>' +
                        glassTypes[type].items.map(item => 
                            `<option value="${item.code}" data-rate="${item.rate}">${item.name}</option>`
                        ).join('');
                    
                    itemCell.focus();
                }
            }
        }
        
        // ADD NEW ROW
        function addNewRow() {
            const table = document.getElementById('productTable');
            const rowId = currentRow++;
            
            const indicatorClass = `indicator-${currentGlassType.toLowerCase()}`;
            
            const rowHTML = `
                <tr id="row-${rowId}">
                    <td>${rowId}</td>
                    <td class="glass-type-cell">
                        <span class="line-indicator ${indicatorClass}">${currentGlassType}</span> ${glassTypes[currentGlassType].name}
                    </td>
                    <td>
                        <select class="form-select form-select-sm item-select" 
                                onchange="updateRate(this, ${rowId})"
                                data-row="${rowId}">
                            <option value="">Select Item</option>
                            ${glassTypes[currentGlassType].items.map(item => 
                                `<option value="${item.code}" data-rate="${item.rate}">${item.name}</option>`
                            ).join('')}
                        </select>
                    </td>
                    <td>
                        <input type="text" class="form-control form-control-sm actual-width" 
                               placeholder="Width" value="0" onchange="calculateRow(${rowId})">
                    </td>
                    <td>
                        <input type="text" class="form-control form-control-sm actual-height" 
                               placeholder="Height" value="0" onchange="calculateRow(${rowId})">
                    </td>
                    <td class="chargable-width">0</td>
                    <td class="chargable-height">0</td>
                    <td>
                        <input type="number" class="form-control form-control-sm qty" 
                               value="1" min="1" onchange="calculateRow(${rowId})">
                    </td>
                    <td>
                        <input type="number" class="form-control form-control-sm rate" 
                               value="${glassTypes[currentGlassType].items[0].rate}" onchange="calculateRow(${rowId})">
                    </td>
                    <td>
                        <input type="number" class="form-control form-control-sm hole" 
                               value="0" min="0" onchange="calculateRow(${rowId})">
                    </td>
                    <td>
                        <input type="number" class="form-control form-control-sm cut" 
                               value="0" min="0" onchange="calculateRow(${rowId})">
                    </td>
                    <td class="area">0.00</td>
                    <td class="amount">0.00</td>
                    <td>
                        <input type="text" class="form-control form-control-sm" placeholder="Remark">
                    </td>
                    <td class="no-print">
                        <button class="btn btn-xs btn-danger" onclick="deleteRow(${rowId})">
                            <i class="fas fa-times"></i>
                        </button>
                    </td>
                </tr>
            `;
            
            table.insertAdjacentHTML('beforeend', rowHTML);
            
            // Focus on width input
            setTimeout(() => {
                const row = document.getElementById(`row-${rowId}`);
                row.querySelector('.actual-width').focus();
            }, 10);
        }
        
        // UPDATE RATE
        function updateRate(select, rowId) {
            const selectedOption = select.options[select.selectedIndex];
            const rate = selectedOption.dataset.rate || 0;
            
            const row = document.getElementById(`row-${rowId}`);
            if (row) {
                row.querySelector('.rate').value = rate;
                calculateRow(rowId);
            }
        }
        
        // CALCULATE ROW
        function calculateRow(rowId) {
            const row = document.getElementById(`row-${rowId}`);
            if (!row) return 0;
            
            const width = parseFloat(row.querySelector('.actual-width').value) || 0;
            const height = parseFloat(row.querySelector('.actual-height').value) || 0;
            const qty = parseFloat(row.querySelector('.qty').value) || 1;
            const rate = parseFloat(row.querySelector('.rate').value) || 0;
            const holeQty = parseFloat(row.querySelector('.hole').value) || 0;
            const cutQty = parseFloat(row.querySelector('.cut').value) || 0;
            
            // Calculate chargable size (+3mm each side)
            const chargableWidth = Math.round(width * 25.4) + 6;
            const chargableHeight = Math.round(height * 25.4) + 6;
            
            // Calculate area in sq.ft
            const area = (width * height) / 144;
            const amount = area * rate * qty;
            
            // Update row
            row.querySelector('.chargable-width').textContent = chargableWidth;
            row.querySelector('.chargable-height').textContent = chargableHeight;
            row.querySelector('.area').textContent = area.toFixed(2);
            row.querySelector('.amount').textContent = amount.toFixed(2);
            
            // Store data
            row.dataset.amount = amount;
            row.dataset.holeQty = holeQty;
            row.dataset.cutQty = cutQty;
            
            // Update summary
            calculateSummary();
            
            return amount;
        }
        
        // CALCULATE ALL
        function calculateAll() {
            let total = 0;
            
            document.querySelectorAll('#productTable tr').forEach(row => {
                if (row.id && row.id.startsWith('row-')) {
                    const rowId = parseInt(row.id.replace('row-', ''));
                    total += calculateRow(rowId) || 0;
                }
            });
            
            calculateSummary();
            showNotification('All calculations completed!');
        }
        
        // CALCULATE SUMMARY
        function calculateSummary() {
            let basicTotal = 0;
            let holeCharges = 0;
            let cutCharges = 0;
            
            document.querySelectorAll('#productTable tr').forEach(row => {
                if (row.dataset.amount) {
                    basicTotal += parseFloat(row.dataset.amount) || 0;
                    holeCharges += (parseFloat(row.dataset.holeQty) || 0) * 50;
                    cutCharges += (parseFloat(row.dataset.cutQty) || 0) * 100;
                }
            });
            
            const docCharges = 500;
            const freightCharges = 1000;
            const totalBeforeTax = basicTotal + holeCharges + cutCharges + docCharges + freightCharges;
            const cgst = totalBeforeTax * 0.09;
            const sgst = totalBeforeTax * 0.09;
            const grandTotal = totalBeforeTax + cgst + sgst;
            
            // Update display
            document.getElementById('basicSubtotal').textContent = '₹' + basicTotal.toFixed(2);
            document.getElementById('holeCharges').textContent = '₹' + holeCharges.toFixed(2);
            document.getElementById('cutCharges').textContent = '₹' + cutCharges.toFixed(2);
            document.getElementById('docCharges').textContent = '₹' + docCharges.toFixed(2);
            document.getElementById('freightCharges').textContent = '₹' + freightCharges.toFixed(2);
            document.getElementById('totalBeforeTax').textContent = '₹' + totalBeforeTax.toFixed(2);
            document.getElementById('cgstAmount').textContent = '₹' + cgst.toFixed(2);
            document.getElementById('sgstAmount').textContent = '₹' + sgst.toFixed(2);
            document.getElementById('grandTotal').textContent = '₹' + grandTotal.toFixed(2);
        }
        
        // DELETE ROW
        function deleteRow(rowId) {
            const row = document.getElementById(`row-${rowId}`);
            if (row && confirm('Delete this row?')) {
                row.remove();
                calculateSummary();
            }
        }
        
        // LOAD CUSTOMERS
        function loadCustomers() {
            customers = [
                { id: 1, name: 'Raj Glass House', city: 'Delhi', gst: '07AABCU9603R1ZX' },
                { id: 2, name: 'Shyam Glass Works', city: 'Noida', gst: '06ABCDE1234F1Z5' }
            ];
            
            const customerSelect = document.getElementById('customerSelect');
            customerSelect.innerHTML = '<option value="">Select Customer</option>' +
                customers.map(cust => `<option value="${cust.id}">${cust.name} (${cust.city})</option>`).join('');
        }
        
        // LOAD CUSTOMER
        function loadCustomer() {
            const custId = document.getElementById('customerSelect').value;
            if (!custId) return;
            
            const customer = customers.find(c => c.id == custId);
            if (customer) {
                document.getElementById('billName').value = customer.name;
                document.getElementById('billCity').value = customer.city;
                document.getElementById('billGST').value = customer.gst;
            }
        }
        
        // COPY TO SHIP
        function copyToShip() {
            if (document.getElementById('sameAsBill').checked) {
                document.getElementById('shipName').value = document.getElementById('billName').value;
                document.getElementById('shipCity').value = document.getElementById('billCity').value;
                document.getElementById('shipGST').value = document.getElementById('billGST').value;
            }
        }
        
        // LOAD GLASS LINES
        function loadGlassLines() {
            const grid = document.getElementById('glassLinesGrid');
            grid.innerHTML = '';
            
            Object.keys(glassTypes).forEach(type => {
                const glass = glassTypes[type];
                const indicatorClass = `indicator-${type.toLowerCase()}`;
                
                const card = document.createElement('div');
                card.className = 'custom-charge-card';
                card.innerHTML = `
                    <h6 class="fw-600 mb-2">
                        <span class="line-indicator ${indicatorClass}">${type}</span> ${glass.name}
                    </h6>
                    <div class="text-sm text-muted mb-2">
                        ${glass.items.length} variants available
                    </div>
                    <div class="d-flex justify-content-between">
                        <span class="badge bg-primary">Rate: ₹${glass.items[0].rate}/sq.ft</span>
                        <button class="btn btn-xs btn-outline-primary" onclick="setGlassType('${type}')">
                            <i class="fas fa-plus"></i> Use
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        // PRINT PROFORMA
        function printProforma() {
            window.print();
        }
        
        // SAVE PROFORMA
        function saveProforma() {
            alert('Proforma saved successfully!');
        }
        
        // CREATE GST INVOICE
        function createGSTInvoice() {
            // Generate 4 copies
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>GST Invoice - ${document.getElementById('piNumber').value}</title>
                    <style>
                        @page { size: A4; margin: 15mm; }
                        body { font-family: Arial, sans-serif; font-size: 11px; }
                        .print-page { page-break-after: always; border: 1px solid #000; padding: 10mm; margin-bottom: 10mm; position: relative; }
                        .copy-number { position: absolute; top: 5mm; right: 10mm; font-size: 14px; font-weight: bold; }
                        .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); font-size: 80px; color: rgba(0,0,0,0.1); }
                    </style>
                </head>
                <body>
                    ${Array(4).fill().map((_, i) => `
                        <div class="print-page">
                            <div class="copy-number">Copy ${i+1}/4</div>
                            ${i > 0 ? '<div class="watermark">GST COPY</div>' : ''}
                            <h2>GST INVOICE</h2>
                            <!-- GST invoice content here -->
                        </div>
                    `).join('')}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // SHOW NOTIFICATION
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 12px 20px;
                border-radius: 4px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-info-circle me-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // SHOW SHORTCUTS HELP
        function showShortcutsHelp() {
            const helpHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                           background: white; padding: 30px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);
                           z-index: 9999; max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4><i class="fas fa-keyboard me-2"></i>Complete Keyboard Shortcuts</h4>
                        <button class="btn btn-sm btn-outline-danger" onclick="this.closest('div').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Glass Type Shortcuts</h5>
                            <div class="mb-2"><kbd>Ctrl+1</kbd> - Clear Glass</div>
                            <div class="mb-2"><kbd>Ctrl+2</kbd> - Patterned Glass</div>
                            <div class="mb-2"><kbd>Ctrl+3</kbd> - Frosted Glass</div>
                            <div class="mb-2"><kbd>Ctrl+4</kbd> - Toughened Glass</div>
                            <div class="mb-2"><kbd>Ctrl+5</kbd> - <strong>Laminated Glass</strong></div>
                            <div class="mb-2"><kbd>Ctrl+6</kbd> - Double Glazed</div>
                            <div class="mb-2"><kbd>Ctrl+7</kbd> - Wired Glass</div>
                            <div class="mb-2"><kbd>Ctrl+8</kbd> - Body Tinted</div>
                            <div class="mb-2"><kbd>Ctrl+9</kbd> - Reflective Glass</div>
                            <div class="mb-2"><kbd>Ctrl+0</kbd> - Designer Glass</div>
                        </div>
                        
                        <div class="col-md-6">
                            <h5>Module Navigation</h5>
                            <div class="mb-2"><kbd>Ctrl+P</kbd> - Proforma Invoice</div>
                            <div class="mb-2"><kbd>Ctrl+O</kbd> - Order Management</div>
                            <div class="mb-2"><kbd>Ctrl+G</kbd> - GST Invoice</div>
                            <div class="mb-2"><kbd>Ctrl+Q</kbd> - Quotation</div>
                            <div class="mb-2"><kbd>Ctrl+C</kbd> - Customer Management</div>
                            <div class="mb-2"><kbd>Ctrl+A</kbd> - Accounting</div>
                            <div class="mb-2"><kbd>Ctrl+I</kbd> - Item Master</div>
                            <div class="mb-2"><kbd>Ctrl+L</kbd> - Glass Lines</div>
                            <div class="mb-2"><kbd>Ctrl+R</kbd> - Reports</div>
                            <div class="mb-2"><kbd>Ctrl+D</kbd> - Dispatch Planner</div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h5>Proforma Operations</h5>
                            <div class="mb-2"><kbd>Insert</kbd> - Add New Row</div>
                            <div class="mb-2"><kbd>F9</kbd> - Calculate All</div>
                            <div class="mb-2"><kbd>Ctrl+P</kbd> - Print Proforma</div>
                            <div class="mb-2"><kbd>Delete</kbd> - Delete Current Row</div>
                            <div class="mb-2"><kbd>Tab</kbd> - Next Field</div>
                            <div class="mb-2"><kbd>Shift+Tab</kbd> - Previous Field</div>
                        </div>
                        
                        <div class="col-md-6">
                            <h5>System Functions</h5>
                            <div class="mb-2"><kbd>F1</kbd> - Show this help</div>
                            <div class="mb-2"><kbd>Ctrl+S</kbd> - Settings</div>
                            <div class="mb-2"><kbd>Ctrl+U</kbd> - User Management</div>
                            <div class="mb-2"><kbd>Ctrl+Shift+A</kbd> - Admin Panel</div>
                            <div class="mb-2"><kbd>Ctrl+Shift+C</kbd> - Custom Charges</div>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-light rounded">
                        <h6><i class="fas fa-bolt me-2"></i>Fast Laminated Glass PI</h6>
                        <ol class="mb-0">
                            <li>Press <kbd>Ctrl+5</kbd> (Laminated Glass)</li>
                            <li>Press <kbd>Insert</kbd> to add row</li>
                            <li>Enter width and height</li>
                            <li>Select laminated variant from dropdown</li>
                            <li>Press <kbd>F9</kbd> to calculate</li>
                            <li>Press <kbd>Ctrl+P</kbd> to print</li>
                        </ol>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <button class="btn btn-primary" onclick="this.closest('div').remove()">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', helpHTML);
        }
        
        // LOGOUT
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.reload();
            }
        }
        
        // ADD CHARGE
        function addCharge() {
            alert('Add Charge feature');
        }
        
        // ADD CHARGE TO PI
        function addChargeToPI(chargeName) {
            alert(`Added ${chargeName} to PI`);
        }
        
        // ADD NEW ORDER
        function addNewOrder() {
            alert('New Order feature');
        }
        
        // ADD NEW CUSTOM CHARGE
        function addNewCustomCharge() {
            alert('Custom Charge feature');
        }
    </script>
</body>
</html>
